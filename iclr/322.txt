Published as a conference paper at ICLR 2018

DIFFUSION CONVOLUTIONAL RECURRENT NEURAL
NETWORK: DATA-DRIVEN TRAFFIC FORECASTING

Yaguang Li†, Rose Yu‡, Cyrus Shahabi†, Yan Liu†
† University of Southern California, ‡ California Institute of Technology
† {yaguang, shahabi, yanliu.cs}@usc.edu, ‡ rose@caltech.edu

ABSTRACT

Spatiotemporal forecasting has various applications in neuroscience, climate and
transportation domain. Trafﬁc forecasting is one canonical example of such learn-
ing task. The task is challenging due to (1) complex spatial dependency on road
networks, (2) non-linear temporal dynamics with changing road conditions and
(3) inherent difﬁculty of long-term forecasting. To address these challenges, we
propose to model the trafﬁc ﬂow as a diffusion process on a directed graph and
introduce Diffusion Convolutional Recurrent Neural Network (DCRNN), a deep
learning framework for trafﬁc forecasting that incorporates both spatial and tem-
poral dependency in the trafﬁc ﬂow. Speciﬁcally, DCRNN captures the spatial
dependency using bidirectional random walks on the graph, and the temporal de-
pendency using the encoder-decoder architecture with scheduled sampling. We
evaluate the framework on two real-world large scale road network trafﬁc datasets
and observe consistent improvement of 12% - 15% over state-of-the-art baselines.

INTRODUCTION

1
Spatiotemporal forecasting is a crucial task for a learning system that operates in a dynamic environ-
ment. It has a wide range of applications from autonomous vehicles operations, to energy and smart
grid optimization, to logistics and supply chain management. In this paper, we study one important
task: trafﬁc forecasting on road networks, the core component of the intelligent transportation systems.
The goal of trafﬁc forecasting is to predict the future trafﬁc speeds of a sensor network given historic
trafﬁc speeds and the underlying road networks.
This task is challenging mainly due to the com-
plex spatiotemporal dependencies and inher-
ent difﬁculty in the long term forecasting. On
the one hand, trafﬁc time series demonstrate
strong temporal dynamics. Recurring incidents
such as rush hours or accidents can cause non-
stationarity, making it difﬁcult to forecast long-
term. On the other hand, sensors on the road
network contain complex yet unique spatial cor-
relations. Figure 1 illustrates an example. Road
1 and road 2 are correlated, while road 1 and
road 3 are not. Although road 1 and road 3
are close in the Euclidean space, they demon-
strate very different behaviors. Moreover, the
future trafﬁc speed is inﬂuenced more by the
downstream trafﬁc than the upstream one. This
means that the spatial structure in trafﬁc is non-
Euclidean and directional.
Trafﬁc forecasting has been studied for decades,
falling into two main categories: knowledge-
driven approach and data-driven approach. In transportation and operational research, knowledge-
driven methods usually apply queuing theory and simulate user behaviors in trafﬁc (Cascetta, 2013).
In time series community, data-driven methods such as Auto-Regressive Integrated Moving Average
(ARIMA) model and Kalman ﬁltering remain popular (Liu et al., 2011; Lippi et al., 2013). However,
simple time series models usually rely on the stationarity assumption, which is often violated by

Figure 1: Spatial correlation is dominated by road
network structure. (1) Trafﬁc speed in road 1 are
similar to road 2 as they locate in the same highway.
(2) Road 1 and road 3 locate in the opposite direc-
tions of the highway. Though close to each other
in the Euclidean space, their road network distance
is large, and their trafﬁc speeds differ signiﬁcantly.

1

